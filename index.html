<!DOCTYPE html>
<html>
<head>
    <title>Letras UAST</title>
    <!-- Incluir o SDK do Pusher Beams -->
    <script src="https://js.pusher.com/beams/1.0/push-notifications-cdn.js"></script>
    <!-- Seu código JavaScript para redirecionamento, notificação e registro do navegador -->
    <script type="text/javascript">
        var userAgent = navigator.userAgent || navigator.vendor || window.opera;

        // Função para enviar uma notificação
        function enviarNotificacao(titulo, mensagem) {
            if (!("Notification" in window)) {
                console.log("Este navegador não suporta notificações.");
            } else if (Notification.permission === 'granted') {
                var notification = new Notification(titulo, {
                    body: mensagem
                });
            } else if (Notification.permission !== 'denied') {
                Notification.requestPermission().then(function (permission) {
                    if (permission === 'granted') {
                        var notification = new Notification(titulo, {
                            body: mensagem
                        });
                    }
                });
            }
        }

        // Função para redirecionar para a página do Notion
        function redirectToNotion() {
            window.location.href = "https://letrasuast.notion.site/Licenciatura-em-Letras-d2ca52cd440b47be969ed7b154bb6d92";
        }

        // Função para redirecionar para a página do Notion (versão mobile)
        function redirectToNotionMobile() {
            window.location.href = "https://letrasuast.notion.site/letrasuast/Licenciatura-em-Letras-Mobile-3c20c5aac0df49139fcfa668f9998e95";
        }

        // Função para checar se há notificações pendentes
        function checarNotificacoes() {
            // Aqui você pode implementar lógica para verificar se há notificações pendentes no servidor ou em algum banco de dados
            // Se houver notificação, você pode chamar enviarNotificacao(titulo, mensagem) com os dados da notificação
            // Por exemplo:
            var titulo = "Nova Notificação";
            var mensagem = "Esta é uma nova notificação do site.";
            enviarNotificacao(titulo, mensagem);
            // Verificar o tipo de dispositivo e redirecionar de acordo
            verificarNavegadorERedirecionar();
        }

        // Função para registrar o navegador e assinar o Device Interest
        function registrarNavegador() {
            const beamsClient = new PusherPushNotifications.Client({
                instanceId: '22a92c74-08f7-44ac-bc3b-eca4e121b2a9',
            });

            beamsClient.start()
                .then(() => beamsClient.addDeviceInterest('hello'))
                .then(() => console.log('Successfully registered and subscribed!'))
                .catch(console.error);
        }

        // Função para verificar o tipo de dispositivo e redirecionar de acordo
        function verificarNavegadorERedirecionar() {
            if (/android/i.test(userAgent)) {
                // Se for Android
                redirectToNotionMobile();
            } else if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
                // Se for iPhone ou iPad
                redirectToNotionMobile();
            } else if (/windows/i.test(userAgent)) {
                // Se for Windows
                redirectToNotion(); // Redirecionar para o Notion padrão
            } else {
                // Para outros dispositivos (Desktop, por exemplo)
                redirectToNotion(); // Redirecionar para o Notion padrão
            }
        }

        // Verificar o tipo de dispositivo e redirecionar de acordo
        if (!("Notification" in window)) {
            console.log("Este navegador não suporta notificações.");
            verificarNavegadorERedirecionar();
        } else if (Notification.permission === 'granted') {
            checarNotificacoes();
        } else if (Notification.permission !== 'denied') {
            Notification.requestPermission().then(function (permission) {
                if (permission === 'granted') {
                    checarNotificacoes();
                }
            });
        } else {
            verificarNavegadorERedirecionar();
        }
    </script>
</head>
<body>
    <!-- Conteúdo da página -->
    <h1>Meu site 2</h1>
    <!-- Texto explicativo sobre a permissão de notificação -->
    <p>Precisamos da sua permissão para enviar notificações informativas sobre atividades, eventos ou comunicados da turma de Letras da UAST.</p>
    <!-- Botão para solicitar permissão de notificação -->
    <button id="btnSolicitarPermissao" style="display: none;" onclick="solicitarPermissao()">Permitir Notificações</button>

    <script>
        // Função para exibir o botão de solicitação de permissão de notificação
        function exibirBotaoSolicitarPermissao() {
            var btnSolicitarPermissao = document.getElementById("btnSolicitarPermissao");
            if (btnSolicitarPermissao) {
                btnSolicitarPermissao.style.display = "block";
            }
        }

        // Função para solicitar permissão de notificação
        function solicitarPermissao() {
            Notification.requestPermission().then(function (permission) {
                if (permission === 'granted') {
                    checarNotificacoes();
                }
            });
        }

        // Verificar se a permissão de notificação foi negada e exibir o botão de solicitação
        if (Notification.permission === 'denied') {
            exibirBotaoSolicitarPermissao();
        }
    </script>
    <!-- Outros elementos do corpo da página -->
</body>
</html>
